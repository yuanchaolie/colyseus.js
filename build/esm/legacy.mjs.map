{"version":3,"file":"legacy.mjs","sources":["../../src/legacy.ts"],"sourcesContent":["//\n// Polyfills for legacy environments\n//\n\n/*\n * Support Android 4.4.x\n */\nif (!ArrayBuffer.isView) {\n    ArrayBuffer.isView = (a: any): a is ArrayBufferView => {\n        return (\n            a !== null &&\n            typeof a === \"object\" &&\n            a.buffer instanceof ArrayBuffer\n        );\n    };\n}\n\n// Define globalThis if not available.\n// https://github.com/colyseus/colyseus.js/issues/86\nif (typeof globalThis === \"undefined\" && typeof window !== \"undefined\") {\n    // @ts-ignore\n    window[\"globalThis\"] = window;\n}\nif (typeof globalThis === \"undefined\") {\n    if (typeof global !== \"undefined\") {\n        // Node.js 或微信小程序环境\n        globalThis = global;\n    } else if (typeof window !== \"undefined\") {\n        // 浏览器环境\n        globalThis = window;\n    } else {\n        // 其他环境，包括微信小程序\n        try {\n            globalThis = Function(\"return this\")();\n        } catch (e) {\n            globalThis = {};\n        }\n    }\n}\n// Cocos Creator does not provide \"FormData\"\n// Define a dummy implementation so it doesn't crash\nif (typeof FormData === \"undefined\") {\n    // @ts-ignore\n    globalThis[\"FormData\"] = class {};\n}\n"],"names":[],"mappings":";AAAA;AACA;AACA;AAEA;;AAEG;AACH,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;AACrB,IAAA,WAAW,CAAC,MAAM,GAAG,CAAC,CAAM,KAA0B;QAClD,QACI,CAAC,KAAK,IAAI;YACV,OAAO,CAAC,KAAK,QAAQ;AACrB,YAAA,CAAC,CAAC,MAAM,YAAY,WAAW;AAEvC,KAAC;AACL;AAEA;AACA;AACA,IAAI,OAAO,UAAU,KAAK,WAAW,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;;AAEpE,IAAA,MAAM,CAAC,YAAY,CAAC,GAAG,MAAM;AACjC;AACA,IAAI,OAAO,UAAU,KAAK,WAAW,EAAE;AACnC,IAAA,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;;QAE/B,UAAU,GAAG,MAAM;;AAChB,SAAA,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;;QAEtC,UAAU,GAAG,MAAM;;SAChB;;AAEH,QAAA,IAAI;AACA,YAAA,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,EAAE;;QACxC,OAAO,CAAC,EAAE;YACR,UAAU,GAAG,EAAE;;;AAG3B;AACA;AACA;AACA,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE;;IAEjC,UAAU,CAAC,UAAU,CAAC,GAAG,MAAA;KAAQ;AACrC"}